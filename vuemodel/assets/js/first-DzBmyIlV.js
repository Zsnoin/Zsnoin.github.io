import{d as m,f as l,b as h,W as f,a1 as o,m as g,ak as w,a3 as C,a5 as x,ab as k,ac as y,Z as p,a6 as E}from"./v-vendor-DseNja-c.js";import"./x-vendor-XSf_N5Ib.js";import"./c-vendor-DT-1cMbM.js";import"./r-vendor-FYZc961W.js";import"./p-vendor-DaMtyeKJ.js";import"./s-vendor-BkeUiZSM.js";import"./d-vendor-D5uLyb19.js";const S=r=>(k("data-v-fc93fba1"),r=r(),y(),r),D={class:"bluetooth-printer"},P=S(()=>o("h2",null,"蓝牙打印机",-1)),T={class:"control-panel"},I=["disabled"],V=["disabled"],B={key:0,class:"print-panel"},M={class:"status-panel"},N=m({__name:"first",setup(r){const s=l(!1),a=l("未连接"),i=l("");let n=null,c=null;const _=async()=>{var e;try{a.value="正在搜索蓝牙设备...",n=await navigator.bluetooth.requestDevice({filters:[{services:["000018f0-0000-1000-8000-00805f9b34fb"]},{namePrefix:"Printer"}],optionalServices:["000018f0-0000-1000-8000-00805f9b34fb"]}),a.value="设备已找到，正在连接...";const t=await((e=n.gatt)==null?void 0:e.connect());if(!t)throw new Error("无法连接到GATT服务器");c=await(await t.getPrimaryService("000018f0-0000-1000-8000-00805f9b34fb")).getCharacteristic("00002af1-0000-1000-8000-00805f9b34fb"),s.value=!0,a.value="已连接到打印机",n.addEventListener("gattserverdisconnected",d)}catch(t){console.error("连接蓝牙打印机失败:",t),a.value=`连接失败: ${t instanceof Error?t.message:"未知错误"}`,s.value=!1}},d=()=>{s.value=!1,a.value="打印机已断开连接",c=null},u=()=>{var e;n&&((e=n.gatt)!=null&&e.connected)&&(n.gatt.disconnect(),d())},b=async()=>{if(!s.value||!c){a.value="打印机未连接";return}try{a.value="正在打印...";const t=new TextEncoder().encode(i.value+`

`);await c.writeValue(t),a.value="打印完成"}catch(e){console.error("打印失败:",e),a.value=`打印失败: ${e instanceof Error?e.message:"未知错误"}`}};return h(()=>{u()}),(e,t)=>(p(),f("div",D,[P,o("div",T,[o("button",{onClick:_,disabled:s.value},"连接打印机",8,I),o("button",{onClick:u,disabled:!s.value},"断开连接",8,V)]),s.value?(p(),f("div",B,[g(o("textarea",{"onUpdate:modelValue":t[0]||(t[0]=v=>i.value=v),placeholder:"输入要打印的内容"},null,512),[[w,i.value]]),o("button",{onClick:b},"打印文本")])):C("",!0),o("div",M,[o("p",null,"状态: "+x(a.value),1)])]))}}),Z=E(N,[["__scopeId","data-v-fc93fba1"]]);export{Z as default};
