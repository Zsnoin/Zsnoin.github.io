import{b as C}from"./wallpaper-CewDAsLV.js";import{d as x,r as d,o as k,w as I,c as s,f as _,a as f,g as y,h as V,i as B,t as $,e as o,j as L,F as h,b as w,_ as P,k as j,n as N,l as E,m as q}from"./index-BAgGJR_R.js";const z={key:0,class:"absolute inset-0 bg-gray-200 animate-pulse"},D=["src","alt"],M={key:1,class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3 transform translate-y-full group-hover:translate-y-0 transition-transform duration-300"},R={class:"text-white text-sm font-medium line-clamp-1"},F={key:2,class:"absolute inset-0 flex items-center justify-center bg-gray-200 text-gray-500 text-sm"},A=x({__name:"ImgLoad",props:{url:{},tag:{default:""}},setup(c){const m=d(null),e=d(!0),n=d(!1),l=c,g=()=>{e.value=!1,n.value=!1},b=()=>{e.value=!1,n.value=!0};return k(()=>{if(!m.value)return;const p=new IntersectionObserver(t=>{t.forEach(i=>{i.isIntersecting&&p.unobserve(i.target)})},{threshold:.1,rootMargin:"0px 0px -50px 0px"})}),(p,t)=>{const i=V("viewer"),a=L("slide-in");return I((o(),s("div",{ref_key:"previewRef",ref:m,class:"relative pb-[56.25%] cursor-pointer overflow-hidden rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 group"},[e.value?(o(),s("div",z)):_("",!0),t[0]||(t[0]=f("img",null,null,-1)),y(i,{images:[l.url],class:"images clearfix"},{default:B(r=>[(o(!0),s(h,null,w(r.images,u=>(o(),s("img",{class:"absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 will-change-transform",src:u,alt:l.tag?l.tag.replace(/,/g," "):"Image",loading:"lazy",onLoad:g,onError:b},null,40,D))),256))]),_:1},8,["images"]),l.tag?(o(),s("div",M,[f("div",R,$(l.tag.replace(/,/g," ")),1)])):_("",!0),n.value?(o(),s("div",F," 加载失败 ")):_("",!0)])),[[a,{distance:100,time:500}]])}}}),O=P(A,[["__scopeId","data-v-89cfbee0"]]),S={class:"flex justify-center items-center space-x-1"},T=["disabled"],U=["onClick"],W={key:1,class:"px-2 py-1 text-gray-500"},G=["disabled"],H=x({__name:"paging",props:{currentPage:{type:Number,required:!0},totalPages:{type:Number,required:!0},maxVisibleButtons:{type:Number,default:5}},emits:["page-changed"],setup(c,{emit:m}){const e=c,n=m,l=j(()=>{if(e.totalPages<=e.maxVisibleButtons)return Array.from({length:e.totalPages},(u,v)=>v+1);const t=[],i=Math.floor(e.maxVisibleButtons/2);let a=e.currentPage-i;a<1&&(a=1);let r=a+e.maxVisibleButtons-1;r>e.totalPages&&(r=e.totalPages,a=r-e.maxVisibleButtons+1,a<1&&(a=1)),a>1&&(t.push(1),a>2&&t.push("..."));for(let u=a;u<=r;u++)t.push(u);return r<e.totalPages&&(r<e.totalPages-1&&t.push("..."),t.push(e.totalPages)),t}),g=t=>{typeof t!="string"&&t!==e.currentPage&&t>=1&&t<=e.totalPages&&n("page-changed",t)},b=()=>{e.currentPage>1&&g(e.currentPage-1)},p=()=>{e.currentPage<e.totalPages&&g(e.currentPage+1)};return(t,i)=>(o(),s("div",S,[f("button",{onClick:b,disabled:c.currentPage===1,class:"px-3 py-1 rounded-md bg-white/80 backdrop-blur-sm border border-gray-300 text-gray-700 hover:bg-blue-500 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"}," ⇐ ",8,T),(o(!0),s(h,null,w(l.value,a=>(o(),s(h,{key:a},[a!=="..."?(o(),s("button",{key:0,onClick:r=>g(a),class:N([{"bg-blue-500 text-white":a===c.currentPage,"bg-white/80 text-gray-700":a!==c.currentPage},"px-3 py-1 rounded-md border border-gray-300 hover:bg-blue-500 hover:text-white transition-colors duration-200 backdrop-blur-sm"])},$(a),11,U)):(o(),s("span",W,"..."))],64))),128)),f("button",{onClick:p,disabled:c.currentPage===c.totalPages,class:"px-3 py-1 rounded-md bg-white/80 backdrop-blur-sm border border-gray-300 text-gray-700 hover:bg-blue-500 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"}," ⇒ ",8,G)]))}}),J=P(H,[["__scopeId","data-v-88d9dffa"]]),K={class:"flex flex-wrap flex-col h-[100vh]"},Q={class:"container mx-auto px-4 py-5 flex-1 overflow-auto"},X={key:0,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},Y={key:1,class:"fixed inset-0 flex items-center justify-center bg-white/30 z-50"},Z={class:"bg-white/80 backdrop-blur-sm pagination p-3 flex justify-center border-t border-gray-200"},ee=21,te=x({__name:"wallpaper360",setup(c){const e=E().query.cid,n=d([]),l=d(1),g=d(0),b=d(0),p=d(!0),t=d(null),i=async()=>{try{p.value=!0,t.value=null;const r=await C.getCategoryWallpaper({cids:e,pageno:l.value,count:ee});n.value=r.data.list||[],g.value=r.data.total_count||0,b.value=r.data.total_page||0}catch(r){console.error("获取壁纸列表失败:",r),t.value="获取壁纸列表失败，请稍后再试"}finally{p.value=!1}},a=r=>{l.value=r,n.value=[],i()};return k(()=>{i()}),q(()=>{}),(r,u)=>(o(),s("div",K,[f("div",Q,[n.value&&n.value.length>0?(o(),s("div",X,[(o(!0),s(h,null,w(n.value,v=>(o(),s("div",{key:v.id,class:"relative"},[y(O,{url:v.url,tag:v.tag},null,8,["url","tag"])]))),128))])):(o(),s("div",Y,u[0]||(u[0]=[f("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"},null,-1)])))]),f("div",Z,[y(J,{"current-page":l.value,"total-pages":b.value,onPageChanged:a},null,8,["current-page","total-pages"])])]))}}),se=P(te,[["__scopeId","data-v-46d2f882"]]);export{se as default};
