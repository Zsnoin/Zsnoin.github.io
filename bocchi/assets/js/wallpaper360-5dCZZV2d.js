import{b as I}from"./wallpaper-CewDAsLV.js";import{d as y,r as u,o as w,w as C,c as s,f as m,a as b,t as k,e as o,g as V,_ as x,h as B,F as _,b as $,n as L,i as j,j as N,k as P}from"./index-CVU7zKUc.js";const E={key:0,class:"absolute inset-0 bg-gray-200 animate-pulse"},q=["src","alt"],z={key:1,class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3 transform translate-y-full group-hover:translate-y-0 transition-transform duration-300"},D={class:"text-white text-sm font-medium line-clamp-1"},M={key:2,class:"absolute inset-0 flex items-center justify-center bg-gray-200 text-gray-500 text-sm"},R=y({__name:"ImgLoad",props:{url:{},tag:{default:""}},setup(c){const h=u(null),e=u(!0),n=u(!1),l=c,d=()=>{e.value=!1,n.value=!1},f=()=>{e.value=!1,n.value=!0};return w(()=>{if(!h.value)return;const g=new IntersectionObserver(t=>{t.forEach(i=>{i.isIntersecting&&g.unobserve(i.target)})},{threshold:.1,rootMargin:"0px 0px -50px 0px"})}),(g,t)=>{const i=V("slide-in");return C((o(),s("div",{ref_key:"previewRef",ref:h,class:"relative pb-[56.25%] cursor-pointer overflow-hidden rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 group"},[e.value?(o(),s("div",E)):m("",!0),b("img",{class:"absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 will-change-transform",src:l.url,alt:l.tag?l.tag.replace(/,/g," "):"Image",loading:"lazy",onLoad:d,onError:f},null,40,q),l.tag?(o(),s("div",z,[b("div",D,k(l.tag.replace(/,/g," ")),1)])):m("",!0),n.value?(o(),s("div",M," 加载失败 ")):m("",!0)])),[[i,{distance:100,time:500}]])}}}),F=x(R,[["__scopeId","data-v-2f8a9022"]]),A={class:"flex justify-center items-center space-x-1"},O=["disabled"],S=["onClick"],T={key:1,class:"px-2 py-1 text-gray-500"},U=["disabled"],W=y({__name:"paging",props:{currentPage:{type:Number,required:!0},totalPages:{type:Number,required:!0},maxVisibleButtons:{type:Number,default:5}},emits:["page-changed"],setup(c,{emit:h}){const e=c,n=h,l=B(()=>{if(e.totalPages<=e.maxVisibleButtons)return Array.from({length:e.totalPages},(p,v)=>v+1);const t=[],i=Math.floor(e.maxVisibleButtons/2);let a=e.currentPage-i;a<1&&(a=1);let r=a+e.maxVisibleButtons-1;r>e.totalPages&&(r=e.totalPages,a=r-e.maxVisibleButtons+1,a<1&&(a=1)),a>1&&(t.push(1),a>2&&t.push("..."));for(let p=a;p<=r;p++)t.push(p);return r<e.totalPages&&(r<e.totalPages-1&&t.push("..."),t.push(e.totalPages)),t}),d=t=>{typeof t!="string"&&t!==e.currentPage&&t>=1&&t<=e.totalPages&&n("page-changed",t)},f=()=>{e.currentPage>1&&d(e.currentPage-1)},g=()=>{e.currentPage<e.totalPages&&d(e.currentPage+1)};return(t,i)=>(o(),s("div",A,[b("button",{onClick:f,disabled:c.currentPage===1,class:"px-3 py-1 rounded-md bg-white/80 backdrop-blur-sm border border-gray-300 text-gray-700 hover:bg-blue-500 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"}," ⇐ ",8,O),(o(!0),s(_,null,$(l.value,a=>(o(),s(_,{key:a},[a!=="..."?(o(),s("button",{key:0,onClick:r=>d(a),class:L([{"bg-blue-500 text-white":a===c.currentPage,"bg-white/80 text-gray-700":a!==c.currentPage},"px-3 py-1 rounded-md border border-gray-300 hover:bg-blue-500 hover:text-white transition-colors duration-200 backdrop-blur-sm"])},k(a),11,S)):(o(),s("span",T,"..."))],64))),128)),b("button",{onClick:g,disabled:c.currentPage===c.totalPages,class:"px-3 py-1 rounded-md bg-white/80 backdrop-blur-sm border border-gray-300 text-gray-700 hover:bg-blue-500 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"}," ⇒ ",8,U)]))}}),G=x(W,[["__scopeId","data-v-88d9dffa"]]),H={class:"flex flex-wrap flex-col h-[100vh]"},J={class:"container mx-auto px-4 py-5 flex-1 overflow-auto"},K={key:0,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},Q={key:1,class:"fixed inset-0 flex items-center justify-center bg-white/30 z-50"},X={class:"bg-white/80 backdrop-blur-sm pagination p-3 flex justify-center border-t border-gray-200"},Y=30,Z=y({__name:"wallpaper360",setup(c){const e=j().query.cid,n=u([]),l=u(1),d=u(0),f=u(0),g=u(!0),t=u(null),i=async()=>{try{g.value=!0,t.value=null;const r=await I.getCategoryWallpaper({cids:e,pageno:l.value,count:Y});n.value=r.data.list||[],d.value=r.data.total_count||0,f.value=r.data.total_page||0}catch(r){console.error("获取壁纸列表失败:",r),t.value="获取壁纸列表失败，请稍后再试"}finally{g.value=!1}},a=r=>{l.value=r,n.value=[],i()};return w(()=>{i()}),N(()=>{}),(r,p)=>(o(),s("div",H,[b("div",J,[n.value&&n.value.length>0?(o(),s("div",K,[(o(!0),s(_,null,$(n.value,v=>(o(),s("div",{key:v.id,class:"relative"},[P(F,{url:v.url,tag:v.tag},null,8,["url","tag"])]))),128))])):(o(),s("div",Q,p[0]||(p[0]=[b("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"},null,-1)])))]),b("div",X,[P(G,{"current-page":l.value,"total-pages":f.value,onPageChanged:a},null,8,["current-page","total-pages"])])]))}}),ae=x(Z,[["__scopeId","data-v-b115fe54"]]);export{ae as default};
